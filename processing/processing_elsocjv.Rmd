



## Grupos Desaventajados: Ingresos tramos

```{r}
sjmisc::frq(procjv$ingreso_tramos)
```

### Recodificacion

```{r}
# Recoficiacion NA
procjv$ingreso_tramos<- set_na(procjv$ingreso_tramos, na = c(-888,-999), drop.levels = TRUE, as.tag = FALSE)

# Creacion variable factor
procjv$ingreso_tramos_factor <- factor(procjv$ingreso_tramos, levels = c(1:16), labels = c("Menos de $40.000 mensuales liquidos",
                                                                                                     "De $40.001 a $85.000 mensuales liquidos",
                                                                                                     "De $85.001 a $125.000 mensuales liquidos",
                                                                                                     "De $125.001 a $170.000 mensuales liquidos",
                                                                                                     "De $170.001 a $210.000 mensuales liquidos",
                                                                                                     "De $210.001 a $230.000 mensuales liquidos",
                                                                                                     "De $230.001 a $280.000 mensuales liquidos",
                                                                                                     "De $280.001 a $320.000 mensuales liquidos",
                                                                                                     "De $320.001 a $360.000 mensuales liquidos",
                                                                                                     "De $360.001 a $400.000 mensuales liquidos",
                                                                                                     "De $400.001 a $465.000 mensuales liquidos",
                                                                                                     "De $465.001 a $540.000 mensuales liquidos",
                                                                                                     "De $540.001 a $665.000 mensuales liquidos",
                                                                                                     "De $665.001 a $850.000 mensuales liquidos",
                                                                                                     "De $850.001 a $1.300.000 mensuales liquidos",
                                                                                                     "Mas de $1.300.001 a mensuales liquidos"))

# Etiquetado variable factor
procjv$ingreso_tramos_factor <- sjlabelled::set_label(procjv$ingreso_tramos_factor, label = "Ingreso mensual del entrevistado en tramos")

# Imputar marcas de clase de ingreso tramo a ingreso monto

# Pero antes, saquemos el promedio de la gente que tiene ingresos mayores al monto del último tramo de ingreso (1.300.001)

ingresos <- procjv$ingreso[procjv$ingreso > 1300001]
ingresos.base <- data.frame(ingresos)
ingresos.base <- na.omit(ingresos.base)
mean(ingresos.base$ingresos)

# El promedio de las 103 personas que tienen ingresos mayores a 1.300.001 es de 2.221.359, por lo que ese será el valor a imputar

procjv$ingreso[procjv$ingreso_tramos == 1] <- 20000
procjv$ingreso[procjv$ingreso_tramos == 2] <- 62500
procjv$ingreso[procjv$ingreso_tramos == 3] <- 105000
procjv$ingreso[procjv$ingreso_tramos == 4] <- 147500
procjv$ingreso[procjv$ingreso_tramos == 5] <- 190000
procjv$ingreso[procjv$ingreso_tramos == 6] <- 220000
procjv$ingreso[procjv$ingreso_tramos == 7] <- 255000
procjv$ingreso[procjv$ingreso_tramos == 8] <- 300000
procjv$ingreso[procjv$ingreso_tramos == 9] <- 340000
procjv$ingreso[procjv$ingreso_tramos == 10] <- 380000
procjv$ingreso[procjv$ingreso_tramos == 11] <- 432500
procjv$ingreso[procjv$ingreso_tramos == 12] <- 502500
procjv$ingreso[procjv$ingreso_tramos == 13] <- 602500
procjv$ingreso[procjv$ingreso_tramos == 14] <- 757500
procjv$ingreso[procjv$ingreso_tramos == 15] <- 1075000
procjv$ingreso[procjv$ingreso_tramos == 16] <- 2221359

# Crear variable de quintiles

# Construccion ingresos per capita quintiles
procjv <- procjv %>% mutate(quintiles_ingreso = ntile(ingreso,5))

## Recuperar NA
procjv$quintiles_ingreso[is.na(procjv$quintiles_ingreso)] <- 99

# Construccion ingresos per capita quintiles factor
procjv$quintiles_ingreso_factor <- factor(procjv$quintiles_ingreso, levels = c(1,2,3,4,5,99), labels = c("Quintil 1", "Quintil 2", "Quintil 3", "Quintil 4", "Quintil 5", "No sabe/No responde"))
procjv$quintiles_ingreso_factor <- set_label(procjv$quintiles_ingreso_factor,label = "Quintiles de ingreso del entrevistado ")

# Construccion ingresos per capita quintiles factor con NS/NR al medio para correlaciones
procjv$quintiles_ingreso_factor_cor <- factor(procjv$quintiles_ingreso, levels = c(1,2,99,3,4,5), labels = c("Quintil 1", "Quintil 2", "Quintil 3", "No sabe/No responde", "Quintil 4", "Quintil 5"))
procjv$quintiles_ingreso_factor_cor <- set_label(procjv$quintiles_ingreso_factor,label = "Quintiles de de ingreso del entrevistado (NS/NR al medio) ")

```

### Descriptivo final

```{r}
sjmisc::frq(procjv$ingreso_tramos)

sjmisc::frq(procjv$ingreso_tramos_factor)

```






## Grupos desaventajados: Satisfaccion con los ingresos

### Descriptivo

```{r}
sjmisc::frq(procjv$ingreso_satisfact)
```

### Recodificacion

```{r}
# Recoficiacion NA
procjv$ingreso_satisfact<- set_na(procjv$ingreso_satisfact, na = c(-888,-999), drop.levels = TRUE, as.tag = FALSE)

# # Aplicar inversión
# procjv$ingreso_satisfact <- car::recode(procjv$ingreso_satisfact,"
#                                               c(5) = 1;
#                                               c(4) = 2;
#                                               c(3) = 3;
#                                               c(2) = 4;
#                                               c(1) = 5")
# 
# procjv$ingreso_satisfact <- sjlabelled::set_labels(procjv$ingreso_satisfact, labels = c(
#   "Totalmente insatisfecho" = 5,
#   "Insatisfecho" = 4,
#   "Ni satisfecho ni insatisfecho" = 3,
#   "Satisfecho" = 2,
#   "Totalmente satisfecho" = 1
# ))
# 
# 
# # Creación variable factor
# procjv$ingreso_satisfact_factor <- factor(procjv$ingreso_satisfact, levels = c(1:5), labels = c("Totalmente satisfecho", "Satisfecho", "Ni satisfecho ni insatisfecho", "Insatisfecho", "Totalmente insatisfecho"))
# 

# Creacion variable factor
procjv$ingreso_satisfact_factor <- factor(procjv$ingreso_satisfact, levels = c(1,2,3,4,5), labels = c("Totalmente insatisfecho",
                                                                                                                  "Insatisfecho",
                                                                                                                  "Ni satisfecho ni insatisfecho",
                                                                                                                  "Satisfecho",
                                                                                                                  "Totalmente satisfecho"))

frq(procjv$ingreso_satisfact_factor)

procjv$ingreso_satisfact_factor <- factor(procjv$ingreso_satisfact_factor, levels = c("Totalmente satisfecho",
                                                                                         "Satisfecho",
                                                                                         "Ni satisfecho ni insatisfecho",
                                                                                         "Insatisfecho",
                                                                                         "Totalmente insatisfecho")
                                                        )

frq(procjv$ingreso_satisfact_factor)



# Etiquetado variable factor
procjv$ingreso_satisfact_factor <- sjlabelled::set_label(procjv$ingreso_satisfact_factor, label = "Satisfaccion Ingresos")
```

### Descriptivo final

```{r}
sjmisc::frq(procjv$ingreso_satisfact)

sjmisc::frq(procjv$ingreso_satisfact_factor)
```


## Grupos Desaventajados: Nivel educacional

### Descriptivo

```{r}
sjmisc::frq(procjv$educ)
```

### Recodificacion

```{r}
# Recoficiacion NA
procjv$educ<- set_na(procjv$educ, na = c(-888,-999), drop.levels = TRUE, as.tag = FALSE)
set_na

# Creacion variable factor
procjv$educ_factor <- factor(procjv$educ, levels = c(1:10), labels = c("Sin estudios",
                                                                                   "Educacion Basica o Preparatoria incompleta",
                                                                                   "Educacion Basica o Preparatoria completa",
                                                                                   "Educacion Media o Humanidades incompleta",
                                                                                   "Educacion Media o Humanidades completa",
                                                                                   "Tecnica Superior incompleta",
                                                                                   "Tecnica Superior completa",
                                                                                   "Universitaria incompleta",
                                                                                   "Universitaria completa",
                                                                                   "Estudios de posgrado (magister o doctorado)"))

# Etiquetado variable factor
procjv$educ_factor <- sjlabelled::set_label(procjv$educ_factor, label = "Nivel educacional del entrevistado")

# Crear variable de educacion recodificada

procjv$educ_rec <- car::recode(procjv$educ, "c(1,2)=1; c(3)=2;c(4,5)=3;c(6,7)=4;c(8,9,10)=5")

# Re etiquetar categorias

procjv$educ_rec <- set_labels(procjv$educ_rec,
            labels=c( "Primaria incompleta menos"=1,
                      "Primaria y secundaria baja"=2,
                      "Secundaria alta"=3,
                      "Terciaria ciclo corto"=4,
                      "Terciaria y Postgrado"=5))

# Etiquetado variable factor
procjv$educ_rec <- sjlabelled::set_label(procjv$educ_rec, label = "Nivel Educacional CINE 11")

# Creacion variable rec factor
procjv$educ_rec_factor <- factor(procjv$educ_rec, levels = c(1,2,3,4,5), labels = c("Primaria incompleta menos",
                                                                                                "Primaria y secundaria baja",
                                                                                                "Secundaria alta",
                                                                                                "Terciaria ciclo corto",
                                                                                                "Terciaria y Postgrado"))



# Etiquetado variable rec factor
procjv$educ_rec_factor <- sjlabelled::set_label(procjv$educ_rec_factor, label = "Nivel Educacional CINE 11")

```

### Descriptivo final

```{r}
sjmisc::frq(procjv$educ)

sjmisc::frq(procjv$educ_factor)

sjmisc::frq(procjv$educ_rec)

sjmisc::frq(procjv$educ_rec_factor)
```

## Grupos Desaventajados: Sexo

### Descriptivo

```{r}
sjmisc::frq(procjv$sexo)
```

### Recodificacion

```{r}
# Recoficiacion NA
procjv$sexo<- set_na(procjv$sexo, na = c(-888,-999), drop.levels = TRUE, as.tag = FALSE)

# Creacion variable factor
procjv$sexo_factor <- factor(procjv$sexo, levels = c(1,2), labels = c("Hombre", "Mujer"))

# Etiquetado variable factor
procjv$sexo_factor <- sjlabelled::set_label(procjv$sexo_factor, label = "Sexo")
```

### Desriptivo final

```{r}
sjmisc::frq(procjv$sexo)

sjmisc::frq(procjv$sexo_factor)
```

## Grupos Desaventajados: Pertenencia a Pueblos indigenas


### Descriptivo

```{r}
sjmisc::frq(procjv$indigena)
```

### Recodificacion

```{r}
# Recoficiacion NA
procjv$indigena <- set_na(procjv$indigena, na = c(-888,-999), drop.levels = TRUE, as.tag = FALSE)

# Crear variable de pertenencia a grupos indigenas recodificada

procjv$indigena_rec <- car::recode(procjv$indigena, "c(10)=1; 
                                   c(2,3,4,5,6,7,8,9,11)=2;
                                   c(1)=3")

procjv$indigena_rec <- sjlabelled::set_label(procjv$indigena_rec, label = "Pertenencia a Pueblo Indigena")

# Creacion variable factor
procjv$indigena_rec_factor <- factor(procjv$indigena_rec, levels = c(1,2,3), labels = c("Ninguno", "Otro pueblo", "Mapuche"))

# Etiquetado variable factor
procjv$indigena_rec_factor <- sjlabelled::set_label(procjv$indigena_rec_factor, label = "Pertenencia a Pueblo Indigena")
```

### Desriptivo final

```{r}
sjmisc::frq(procjv$indigena)

sjmisc::frq(procjv$indigena_rec_factor)
```






